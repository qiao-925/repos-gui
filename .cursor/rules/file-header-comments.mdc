---
description: "代码文件顶部注释规范"
globs:
  - "**/*.sh"
  - "**/*.js"
  - "**/*.ts"
  - "**/*.py"
  - "**/*.java"
  - "**/*.go"
alwaysApply: true
priority: 1
---

# 代码文件顶部注释规范

## 核心规则

**所有代码文件（.sh, .js, .ts, .py, .java, .go 等）必须在文件顶部包含功能描述注释。**

## 强制要求

### 1. 注释位置

- **必须位置**：文件的第一行或第二行（shebang 之后）开始
- **格式要求**：使用注释符号（`#`、`//`、`/* */` 等，根据语言而定）

### 2. 注释内容要求

每个文件的顶部注释**必须**包含以下内容：

1. **文件功能概述**（必需）
   - 简洁说明这个文件的主要功能
   - 1-2 句话概括

2. **主要功能模块**（必需）
   - 列出文件中的主要函数/类/模块
   - 简要说明每个模块的作用
   - 使用列表格式，保持简洁

3. **执行流程/使用方式**（可选，复杂文件建议包含）
   - 如果是脚本文件，说明执行流程
   - 如果是库文件，说明主要使用方式

4. **特性/注意事项**（可选，重要特性建议包含）
   - 关键特性说明
   - 重要的使用注意事项

### 3. 注释风格要求

- **简洁明了**：避免过于冗长的描述
- **重点突出**：优先说明核心功能
- **结构清晰**：使用适当的格式和缩进
- **易于理解**：使用清晰的语言，避免过于技术化的术语

### 4. 注释模板

#### Shell 脚本模板

```bash
#!/bin/bash
# [模块名称]：简要功能描述
#
# 主要功能：
#   - function1()：功能说明
#   - function2()：功能说明
#   - function3()：功能说明
#
# 执行流程：
#   1. 步骤1
#   2. 步骤2
#   3. 步骤3
#
# 特性：
#   - 特性1
#   - 特性2
```

#### 其他语言模板

根据语言使用相应的注释格式，但内容结构相同。

## AI Agent 行为要求

1. **创建新文件时**：
   - 必须自动添加符合规范的文件顶部注释
   - 根据文件内容分析功能并生成注释

2. **修改现有文件时**：
   - 如果文件缺少顶部注释，必须添加
   - 如果文件顶部注释不完整，必须补充
   - 如果文件顶部注释过于复杂，必须简化

3. **注释检查**：
   - 在代码审查时检查文件顶部注释
   - 确保注释与实际代码功能一致
   - 确保注释简洁明了，不过于冗长

## 示例

### 示例 1：Shell 脚本

```bash
#!/bin/bash
# GitHub 仓库批量克隆脚本：极简设计，专注于核心功能
#
# 主要功能：
#   - parse_args()：解析命令行参数（-t 并行任务数，-c 并行传输数）
#   - parse_repo_groups()：读取并解析 REPO-GROUPS.md 配置文件
#   - execute_parallel_clone()：并行批量克隆所有仓库
#   - print_summary()：输出最终统计报告
#
# 执行流程：
#   1. 解析命令行参数
#   2. 加载配置文件
#   3. 构建克隆任务列表
#   4. 并行执行克隆
#   5. 输出统计报告
#
# 特性：
#   - 双重并行：应用层并行（-t） + Git 层并行传输（-c）
#   - 直接覆盖：不检查仓库是否存在，直接克隆
#   - 完整克隆：全部使用完整克隆，不使用浅克隆
```

### 示例 2：JavaScript 模块

```javascript
// 工具函数模块：提供常用的工具函数
//
// 主要功能：
//   - formatDate()：格式化日期
//   - debounce()：防抖函数
//   - throttle()：节流函数
//
// 使用方式：
//   import { formatDate, debounce } from './utils.js'
```

## 例外情况

以下文件可以适当简化注释：

1. **配置文件**（如 JSON、YAML、XML 等）：可以只有简单说明
2. **测试文件**：可以只说明测试目标
3. **非常简单的工具文件**（少于 50 行）：可以只包含功能概述

## 维护建议

- 在代码审查时检查文件顶部注释
- 当文件功能发生变化时，及时更新注释
- 保持注释与实际代码的一致性
